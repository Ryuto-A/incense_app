<h2>レビュー一覧</h2>

<h2>レビュー一覧</h2>

<% if user_signed_in? %>
  <div class="mb-3">
    <%= link_to "レビューを投稿する", new_incense_review_path, class: "btn btn-outline-primary" %>
  </div>
<% end %>

<% @incense_reviews.each do |review| %>
  <div class="card mb-3">

    <%# 画像エリア: CLS対策としてアスペクト比を先に確保（4:3）。中の画像は responsive_image ヘルパでレスポンシブ配信 %>
    <div class="ratio ratio-4x3 card-img-top overflow-hidden">
      <%= responsive_image(
            review,
            alt: "#{review.title} の画像",
            attachment_name: :photo,                    # Active Storage 添付名
            fallback_url: review.product_image,         # 画像が無い場合の外部URLフォールバック
            widths: [320, 640, 960, 1280],              # 生成する派生サイズ
            sizes: "100vw",                             # 現状は1カラム想定。後で複数カラム化するなら調整
            class_name: "w-100 h-100 object-fit-cover"  # 枠いっぱいに表示
          ) %>
    </div>

    <div class="card-body">
      <h5 class="card-title"><%= link_to review.title, review %></h5>
      <p class="card-text"><strong>香りのカテゴリ:</strong> <%= review.scent_category.humanize %></p>
      <p class="card-text"><strong>煙の強さ:</strong> <%= review.smoke_intensity %></p>
      <p class="card-text"><%= truncate(review.content, length: 100) %></p>
      <%= link_to "続きを読む", review, class: "btn btn-outline-primary" %>
    </div>
  </div>
<% end %>
